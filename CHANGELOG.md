## 0.5.3(2025-07-29)

> 说明：建议升级到此版本，以获取更好性能。

特性：

改进：
- 优化本地IP获取逻辑；

Bug修复：
- 修复V3协议读取响应时潜在的数据竞争问题；



## 0.5.2(2025-02-08)

> 说明：建议升级到此版本，以获取更好性能。

特性：

改进：
- 简化连接池中删除过期连接的逻辑，提高代码可维护性；
- 删除DNS域名解析模块中的不必要的default分支，降低CPU占用（约0.4%）；

Bug修复：



## 0.5.1(2025-01-21)

> 说明：建议升级到此版本，避免触发隐藏的Bug。

特性：

改进：
- 开启TCP-Keep-Alive；
- 将连接池初始值设置为2048，支持大集群；

Bug修复：
- 修复在连接生命周期配置为0时CPU占用过高的问题，此问题为v0.5.0引入，当前SDK默认的连接生命周期为5m，不受影响，受影响的SDK为tdbus-go。


## 0.5.0(2025-01-10)

> 说明：建议升级到此版本。
> - 可以使得CLB负载更加均衡，使用TCP协议时，服务器升级更简单；
> - v0.4.3及以前版本在使用TCP协议时，重启服务器需要替换CLB的方式才能实现不丢失数据。

特性：
- 连接池中的连接支持配置最大生命周期；
- 增加连接最大生命周期配置。

改进：
- 初始化失败时，关闭已经打开的连接；
- 将连接生命周期设置为5m，支持使用TCP协议时，服务器可以在CLB通过修改权重为0、等连接数降为0、解绑、重启、重新绑定的方式升级且不丢失数据；
- 将连接生命周期设置为5m，使得使用CLB时，负载加均衡；
- 关闭一些调试日志；
- 只有一个服务器节点时，连接异常关闭时不再将节点标识为不可用以更好的处理只跟一个CLB通信的场景；
- 测试客户端增加启用指标命令行选项方便测试时获取指标；
- 屏蔽一些lint告警；
> 说明：UDP可直接修改权重为0，解绑、重启、重新绑定不丢数据。

Bug修复：



## 0.4.3(2024-12-16)

> 说明：建议升级到此版本，避免触发隐藏的Bug。

特性：

改进：
- 优化uuid生成性能；

Bug修复：
- 修复data race问题。



## 0.4.2(2024-12-09)
> 说明：建议升级到此版本，避免触发隐藏的Bug。

特性：

改进：
- 将默认重试次数改为3。日常运营发现，使用TCP时，在CLB解绑RS时，使用1次重传仍然会有丢数据的可能，使用3次重传时反复绑定、解绑都正常；
- 将UDP探测功能删除。目前生产环境服务器都绑定在CLB后面，UDP探测不生效，在macOS下还无法编译，此功能比较鸡肋；
- 升级依赖包；

Bug修复：


## 0.4.1(2024-08-16)

> 说明：建议升级到此版本，避免触发隐藏的Bug。

特性：

改进：
- 升级依赖包；
- 鉴于目前生产环境服务器都绑定在CLB后面，UDP探测不生效，改为默认关闭UDP探测，废弃`WithNoUDPProbe()`接口，如果需要启用，请调用`WithUDPProbe()`接口；

Bug修复：


## 0.4.0(2024-07-17)

> 说明：建议升级到此版本，避免触发隐藏的Bug。

特性：
- 支持UDP探活（支持配置禁用、连接超时、请求超时）；
- 支持服务器故障恢复探测（包括UDP服务）；
- 定时打印连接池内部状态；

改进：
- 升级依赖包；
- 重试退避策略改为指数退避；
- 用并发的方式创建初始连接；

Bug修复：
- 修复服务器主动断开连接时gnet连接更新方式不正确的问题，此问题有可能导致SDK死锁；
- 修复gnet连接UDP发包失败时的处理方式不正确的问题，此问题有可能在发送失败时也认为成功；



## 0.3.6(2024-05-28)

> 说明：建议升级到此版本，避免触发隐藏的Bug。

特性：

改进：
- 升级依赖包；

Bug修复：
- 修复连接池更新连接时，取连接远程地址时没有判断地址是否有效的Bug，此Bug在有连接的远程服务主动关闭连接后，服务发现又正好触发连接更新时会导致panic；



## 0.3.5(2024-05-20)

> 说明：此版本以前的版本只能使用gnetV2.3及以前的版本。

特性：

改进：
- 升级依赖包；

Bug修复：
- 修复示例代码的成功、失败计数错误；
- 修复gnet库的错误使用方式，此Bug会导致升级gnet到2.4及以上版本后SDK初始化阻塞。



## 0.3.4(2023-10-31)

> 说明：建议升级到此版本，可以大幅度降低内存占用。

特性：

改进：
- 小对象放入chan时也放指针，降低内存占用；
- `batchReq`和`sendDataReq`释放的时候，清空指针字段 ；
- 修改网络相关的读写缓冲区默认值为1M和8M；
- 升级依赖包；

Bug修复：


## 0.3.3(2023-10-30)

特性：

改进：
- 使用uuid作为请求ID，不依赖于snowflake ID；
- 初始化时只获取IP，不强制获取私有IP；
- 获取worker时，如果其队列满，直接返回错误，不再尝试其他worker，fail fast；
- 缓存`batchReq.data`；
- 修改MaxRetries、BatchingMaxPublishDelay、MaxPendingMessages默认值为1、20ms、204800；
- 升级依赖包；

Bug修复：


## 0.3.2(2023-09-13)

特性：

改进：
- 修改部署静态代码检查告警；
- 升级依赖库；

Bug修复：


## 0.3.1(2023-08-04)

特性：

改进：
- 测试程序默认异步发送；

Bug修复：
- 修复解密函数一个填充字段未检查越界的问题；


## 0.3.0(2023-07-28)

> 说明：如果使用V3协议，此版本及以后的版本需要与v0.9.0及以后版本的服务器配套使用。V1协议不影响。

特性：
- V3协议支持鉴权和签名；

改进：
- 池化sendDataReq和batchReq，提高性能；
- 池化V3协议请求和响应，提高性能；
- 测试程序支持鉴权和签名；
- 升级gnet版本；
- 升级压缩库的版本；
- 升级prometheus库版本；
- 调试日志默认实现不再打印Debug级别日志；

Bug修复：


升级指引：

鉴权和签名数据需要加密传输，所以，开启鉴权/签名时，必须配置加密密钥EncryptKey；

开启鉴权时，需要配置AppID；

开启鉴权时，需要配置Token和TokenType，支持bearer/tglog两种类型，bearer为JWT，tglog为tglog实现的一种token；

- 鉴权

  - 相关配置项

    ```go
    AppID                   string                // 业务ID，V3协议有效，默认：空，开启鉴权时必填
    EncryptKey              string                // 加密密钥，V3协议有效，默认：无，开启鉴权/签名时必填
    Token                   string                // 鉴权令牌，V3协议有效，默认：无
    TokenType               string                // 鉴权令牌类型，V3协议有效，默认：无，可选值：bearer/tglog，bearer为JWT，tglog为tglog实现的一种token	
    Auth                    bool                  // 是否携带鉴权参数，默认：false
    ```

- 签名

  - 相关配置

    ```go
    EncryptKey              string                // 加密密钥，V3协议有效，默认：无，开启鉴权/
    Sign                    bool                  // 是否签名，V3协议有效，默认：false
    ```


## 0.2.6(2023-07-11)

> 说明：

特性：

改进：
- 更新go的依赖版本号；
- 优化更新连接的处理逻辑；
- 优化发送失败的异步处理逻辑；
- 更新默认批次消息条数为50；
- 更新默认批次大小为8K；
- 更新一些注释；
- 降级部分调试日志；
- `Send()`方法支持context超时/退出；

Bug修复：


## 0.2.5(2023-06-12)

> 说明：

特性：

改进：
- 增加`UpdateInterval`配置项；
- 将测试程序的`rate`参数类型修改为float64；

Bug修复：


## 0.2.4(2023-05-22)

> 说明：此版本与v0.2.3一样，因我们删除过v0.2.3重新发过版本，而有同事通过内部代理引用了v0.2.3无法通过删除缓存缓解，所以重新打tag发版本。

特性：

改进：

Bug修复：


## 0.2.3(2023-05-18)

特性：

改进：
- 默认超时时间改为30s；
- 将发送超时检测的定时器检测周期改为发送超时的一半；

Bug修复：
- 修复`rand()`函数的并发安全问题；
- 将gnet升级到v2.2.9修改`AsyncWrite()'在连接被服务器断开时无法触发回调的问题以及打印warn以上级别日志会打印调用栈的问题；


## 0.2.2(2023-04-11)

特性：

改进：
- 根据测试经验，调整配置的默认值；
- 添加更多错误码及其监控；
- 将panic时的栈信息打印到调试日志；

Bug修复：
- 修复worker错误码的字符串值一样的问题；


## 0.2.1(2023-04-01)

特性：

改进：

Bug修复：
- 修复将连接放回连接池会panic的问题，根本原因未知；


## 0.2.0(2023-03-23)

特性：

- 实现backoff重试；


改进：

- worker队列满/不可用，暂停给它分派数据；
- worker连接更新时间在[30,80]之间随机；
- 优化错误码；
- 一些监控指标添加更多标签，可以更精细化的监控；
- 默认消息发送超时改为5s；

Bug修复：
- 修复了连接池的一些代码问题；


## 0.1.0(2023-03-06)

特性：

- 支持域名后端RS刷新；
- 支持同步上报；
- 支持批量异步上报；
- 兼容TGLogV1协议；
- 支持TGLogV3协议；
- 支持压缩与加密（V3协议）；
- 支持优雅关闭；

改进：

Bug修复：


## 0.0.0(2023-02-03)

特性：

- 项目初始化；

改进：

Bug修复：